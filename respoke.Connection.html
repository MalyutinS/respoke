<!-- Copyright 2014, Digium, Inc.--><!-- All rights reserved.--><!----><!-- This source code is licensed under The MIT License found in the--><!-- LICENSE file in the root directory of this source tree.--><!----><!-- For all details and documentation:  https://www.respoke.io--><!DOCTYPE html><html><head><title>respoke/connection.js - respoke.Connection</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><link rel="stylesheet" href="https://highlightjs.org/static/styles/github.css"><script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script src="https://highlightjs.org/static/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="container"><div id="respoke-Connection" class="comment"><p><strong>extends&nbsp;<a href="/js-library/respoke.Presentable.html"><code>respoke.Presentable</code></a></strong></p><div><p>A <code>respoke.Connection</code> always belongs to an Endpoint.</p>
<p>There is a distinction between Endpoint and Connection because an Endpoint can be authenticated
from multiple devices, browsers, or browser tabs. Each of these separate authentications is a Connection.
A Client can choose to interact with connections of the same endpoint in different ways.</p>
</div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.id</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><br><br><h2>Properties and Methods</h2></div><div id="id" class="comment"><h3><code>string</code><a href="#id" class="bold"> respoke.Connection.id</a></h3><div><p>The connection id.</p>
</div><br><br></div><div id="sendMessage" class="comment"><h3><a href="#sendMessage"><span class="bold"> respoke.Connection.sendMessage(params)</span></a></h3><p><strong>returns<code>Promise|undefined</code></strong></p><div><p>Send a message to this connection of an endpoint. If the endpoint has multiple connections,
it will only receive the message at this connection.</p>
<pre><code>connection.sendMessage({
    message: &quot;PJ, put that PBR down!&quot;
});
</code></pre><p><strong>Using callbacks</strong> will disable promises.</p>
</div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>params.message</code></div><div class="col-sm-3"><strong>string</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onSuccess]</code></div><div class="col-sm-3"><strong>respoke.Client.successHandler</strong></div><div class="col-sm-5">Success handler for this invocation
of this method only.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.Client.errorHandler</strong></div><div class="col-sm-5">Error handler for this invocation of this
method only.</div></div><br class="visible-xs"><br><br></div><div id="startCall" class="comment"><h3><a href="#startCall"><span class="bold"> respoke.Connection.startCall(params)</span></a></h3><p><strong>returns<code>respoke.Call</code></strong></p><div><p>Create a new Call for a voice and/or video call this particular connection, only. The Call cannot be answered
by another connection of this Endpoint.</p>
<pre><code>connection.startCall({
    onConnect: function (evt) {}
});
</code></pre></div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.Call.onError</strong></div><div class="col-sm-5">Callback for errors that happen during call setup or
media renegotiation.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onLocalMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onLocalMedia</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the local audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onConnect]</code></div><div class="col-sm-3"><strong>respoke.Call.onConnect</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the remote
audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onHangup]</code></div><div class="col-sm-3"><strong>respoke.Call.onHangup</strong></div><div class="col-sm-5">Callback for being notified when the call has been
hung up.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAllow]</code></div><div class="col-sm-3"><strong>respoke.Call.onAllow</strong></div><div class="col-sm-5">When setting up a call, receive notification that the
browser has granted access to media.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onMute]</code></div><div class="col-sm-3"><strong>respoke.Call.onMute</strong></div><div class="col-sm-5">Callback for changing the mute state on any type of media.
This callback will be called when media is muted or unmuted.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAnswer]</code></div><div class="col-sm-3"><strong>respoke.Call.onAnswer</strong></div><div class="col-sm-5">Callback for when the callee answers the call.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onApprove]</code></div><div class="col-sm-3"><strong>respoke.Call.onApprove</strong></div><div class="col-sm-5">Callback for when the user approves local media. This
callback will be called whether or not the approval was based on user feedback. I. e., it will be called even if
the approval was automatic.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onRequestingMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onRequestingMedia</strong></div><div class="col-sm-5">Callback for when the app is waiting
for the user to give permission to start getting audio or video.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onStats]</code></div><div class="col-sm-3"><strong>respoke.MediaStatsParser.statsHandler</strong></div><div class="col-sm-5">Callback for receiving statistical
information.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.previewLocalMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.previewLocalMedia</strong></div><div class="col-sm-5">A function to call if the developer
wants to perform an action between local media becoming available and calling approve().</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.constraints]</code></div><div class="col-sm-3"><strong>RTCConstraints</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.receiveOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we accept media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.sendOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we send media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.needDirectConnection]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">flag to enable skipping media &amp; opening direct connection.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.forceTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow peer-to-peer and must flow through
relay servers. If it cannot flow through relay servers, the call will fail.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.disableTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow through relay servers; it is
required to flow peer-to-peer. If it cannot, the call will fail.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.videoLocalElement]</code></div><div class="col-sm-3"><strong>HTMLVideoElement</strong></div><div class="col-sm-5">Pass in an optional html video element to have local video attached to it.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.videoRemoteElement]</code></div><div class="col-sm-3"><strong>HTMLVideoElement</strong></div><div class="col-sm-5">Pass in an optional html video element to have remote video attached to it.</div></div><br class="visible-xs"><br><br></div><div id="startAudioCall" class="comment"><h3><a href="#startAudioCall"><span class="bold"> respoke.Connection.startAudioCall(params)</span></a></h3><p><strong>returns<code>respoke.Call</code></strong></p><div><p>Create a new audio-only call.</p>
<pre><code>connection.startAudioCall({
    onConnect: function (evt) {}
});
</code></pre></div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.Call.onError</strong></div><div class="col-sm-5">Callback for errors that happen during call setup or
media renegotiation.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onLocalMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onLocalMedia</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the local audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onConnect]</code></div><div class="col-sm-3"><strong>respoke.Call.onConnect</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the remote
audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onHangup]</code></div><div class="col-sm-3"><strong>respoke.Call.onHangup</strong></div><div class="col-sm-5">Callback for being notified when the call has been
hung up.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAllow]</code></div><div class="col-sm-3"><strong>respoke.Call.onAllow</strong></div><div class="col-sm-5">When setting up a call, receive notification that the
browser has granted access to media.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onMute]</code></div><div class="col-sm-3"><strong>respoke.Call.onMute</strong></div><div class="col-sm-5">Callback for changing the mute state on any type of media.
This callback will be called when media is muted or unmuted.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAnswer]</code></div><div class="col-sm-3"><strong>respoke.Call.onAnswer</strong></div><div class="col-sm-5">Callback for when the callee answers the call.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onApprove]</code></div><div class="col-sm-3"><strong>respoke.Call.onApprove</strong></div><div class="col-sm-5">Callback for when the user approves local media. This
callback will be called whether or not the approval was based on user feedback. I. e., it will be called even if
the approval was automatic.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onRequestingMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onRequestingMedia</strong></div><div class="col-sm-5">Callback for when the app is waiting
for the user to give permission to start getting audio or video.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onStats]</code></div><div class="col-sm-3"><strong>respoke.MediaStatsParser.statsHandler</strong></div><div class="col-sm-5">Callback for receiving statistical
information.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.previewLocalMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.previewLocalMedia</strong></div><div class="col-sm-5">A function to call if the developer
wants to perform an action between local media becoming available and calling approve().</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.receiveOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we accept media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.sendOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we send media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.needDirectConnection]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">flag to enable skipping media &amp; opening direct connection.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.forceTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow peer-to-peer and must flow through
relay servers. If it cannot flow through relay servers, the call will fail.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.disableTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow through relay servers; it is
required to flow peer-to-peer. If it cannot, the call will fail.</div></div><br class="visible-xs"><br><br></div><div id="startVideoCall" class="comment"><h3><a href="#startVideoCall"><span class="bold"> respoke.Connection.startVideoCall(params)</span></a></h3><p><strong>returns<code>respoke.Call</code></strong></p><div><p>Create a new call with audio and video.</p>
<pre><code>connection.startVideoCall({
    onConnect: function (evt) {}
});
</code></pre></div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.Call.onError</strong></div><div class="col-sm-5">Callback for errors that happen during call setup or
media renegotiation.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onLocalMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onLocalMedia</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the local audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onConnect]</code></div><div class="col-sm-3"><strong>respoke.Call.onConnect</strong></div><div class="col-sm-5">Callback for receiving an HTML5 Video
element with the remote
audio and/or video attached.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onHangup]</code></div><div class="col-sm-3"><strong>respoke.Call.onHangup</strong></div><div class="col-sm-5">Callback for being notified when the call has
been hung up.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAllow]</code></div><div class="col-sm-3"><strong>respoke.Call.onAllow</strong></div><div class="col-sm-5">When setting up a call, receive notification that the
browser has granted access to media.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onMute]</code></div><div class="col-sm-3"><strong>respoke.Call.onMute</strong></div><div class="col-sm-5">Callback for changing the mute state on any type of media.
This callback will be called when media is muted or unmuted.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAnswer]</code></div><div class="col-sm-3"><strong>respoke.Call.onAnswer</strong></div><div class="col-sm-5">Callback for when the callee answers the call.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onApprove]</code></div><div class="col-sm-3"><strong>respoke.Call.onApprove</strong></div><div class="col-sm-5">Callback for when the user approves local media. This
callback will be called whether or not the approval was based on user feedback. I. e., it will be called even if
the approval was automatic.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onRequestingMedia]</code></div><div class="col-sm-3"><strong>respoke.Call.onRequestingMedia</strong></div><div class="col-sm-5">Callback for when the app is waiting
for the user to give permission to start getting audio or video.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onStats]</code></div><div class="col-sm-3"><strong>respoke.MediaStatsParser.statsHandler</strong></div><div class="col-sm-5">Callback for receiving statistical
information.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.receiveOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we accept media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.sendOnly]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">whether or not we send media</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.needDirectConnection]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">flag to enable skipping media &amp; opening direct connection.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.forceTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow peer-to-peer and must flow through
relay servers. If it cannot flow through relay servers, the call will fail.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.disableTurn]</code></div><div class="col-sm-3"><strong>boolean</strong></div><div class="col-sm-5">If true, media is not allowed to flow through relay servers; it is
required to flow peer-to-peer. If it cannot, the call will fail.</div></div><br class="visible-xs"><br><br></div><div id="startDirectConnection" class="comment"><h3><a href="#startDirectConnection"><span class="bold"> respoke.Connection.startDirectConnection(params)</span></a></h3><p><strong>returns<code>respoke.DirectConnection</code></strong></p><div><p>Create a new DirectConnection with this particular connection, only. The DirectConnection cannot be answered
by another connection of this Endpoint.  This method creates a new Call as well, attaching this
DirectConnection to it for the purposes of creating a peer-to-peer link for sending data such as messages to
the other endpoint. Information sent through a DirectConnection is not handled by the cloud infrastructure.</p>
<pre><code>connection.startDirectConnection({
    onOpen: function (evt) {}
});
</code></pre></div><br><h4>Arguments</h4><div class="row hidden-xs param"><div class="col-sm-4">Name</div><div class="col-sm-3">Type</div><div class="col-sm-5"></div></div><div class="row param"><div class="col-sm-4"><code>params</code></div><div class="col-sm-3"><strong>object</strong></div><div class="col-sm-5"></div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onSuccess]</code></div><div class="col-sm-3"><strong>respoke.Call.directConnectionSuccessHandler</strong></div><div class="col-sm-5">Success handler for this
invocation of this method only.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.Client.errorHandler</strong></div><div class="col-sm-5">Error handler for this invocation of this
method only.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onStart]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onStart</strong></div><div class="col-sm-5">A callback for when setup of the direct
connection begins. The direct connection will not be open yet.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onOpen]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onOpen</strong></div><div class="col-sm-5">A callback for receiving notification of when
the DirectConnection is open and ready to be used.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onError]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onError</strong></div><div class="col-sm-5">Callback for errors setting up the direct
connection.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onClose]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onClose</strong></div><div class="col-sm-5">A callback for receiving notification of
when the DirectConnection is closed and the two Endpoints are disconnected.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onMessage]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onMessage</strong></div><div class="col-sm-5">A callback for receiving messages sent
through the DirectConnection.</div></div><br class="visible-xs"><div class="row param"><div class="col-sm-4"><code>[params.onAccept]</code></div><div class="col-sm-3"><strong>respoke.DirectConnection.onAccept</strong></div><div class="col-sm-5">Callback for when the user accepts the
request for a direct connection and setup begins.</div></div><br class="visible-xs"><br><br></div><div id="getEndpoint" class="comment"><h3><a href="#getEndpoint"><span class="bold"> respoke.Connection.getEndpoint()</span></a></h3><p><strong>returns<code>respoke.Endpoint</code></strong></p><div><p>Get the Endpoint that this Connection belongs to.</p>
</div><br><br></div><div id="log" class="comment"><h3><a href="#log"><span class="bold"> respoke.Connection.log()</span></a></h3><div><p>Copyright 2014, Digium, Inc.
All rights reserved.</p>
<p>This source code is licensed under The MIT License found in the
LICENSE file in the root directory of this source tree.</p>
<p>For all details and documentation:  <a href="https://www.respoke.io">https://www.respoke.io</a></p>
</div><br><br></div></div></body></html>